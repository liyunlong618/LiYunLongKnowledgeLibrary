___________________________________________________________________________________________
> [!!!!!!!!!!!项目根目录!!!!!!!!!!!](./!!!!!!!!!!!项目目录!!!!!!!!!!!.md)

___________________________________________________________________________________________

# GAS 3.2 绑定GE委托，通过收到的的资产标签，广播信息结构体，触发UI中绑定的WidgetController回调，UI中拿到生成MessageUI的信息
___________________________________________________________________________________________
## 处理关键点
1. 这里是关键点
2. 这里是关键点
3. 这里是关键点
4. 这里是关键点
5. 这里是关键点
6. 这里是关键点
7. 这里是关键点
8. 这里是关键点
9. 这里是关键点
10. 这里是关键点
___________________________________________________________________________________________

[TOC]

___________________________________________________________________________________________

_ <font color=#DC2D1E>**处理关键点：**</font>
    _ <font color=#DC2D1E>**1.使用ASC组件基类中，写好的委托 OnGameplayEffectAppliedDelegateToSelf（当应用GE到ASC时触发回调）**</font>
    _ <font color=#DC2D1E>**2.一次性道具 配置资产标签AssetTag，这样可以在触发回调时通过FGameplayEffectSpec类的对象拿到FGameplayTagContainer（这个相当于水杯，tag相当于水）**</font>
    _ <font color=#DC2D1E>**3.使用GEngine_>AddOnScreenDebugMessage（相当于PrintString）发Message到视口**</font>
    _ <font color=#DC2D1E>**4.先创建表格结构体（需要继承FTableRowBase！！！）在创建模板类，根据传入的表格查找指定行（FindRow，这里行命名实用了tag字符串的格式，便于查找）**</font>
    _ <font color=#DC2D1E>**5.UPROPERTY(EditDefaultOnly)宏//在编辑器中显示并允许编辑这些属性的默认值，但不允许在实例级别进行修改。**</font>
    _ <font color=#DC2D1E>**6.C++中创建Tag标签：FGameplayTag::RequestGameplayTag(FName("Message"))；并使用API（父类标签包含子类标签前提下） ：子类Tag.MatchesTag(父类Tag)检查子类标签中是否包含父类标签，若反过来检查则不生效，请注意！！！**</font>
_ UAbilitySystemComponent中的多播位置
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/947244_743569.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/644032_611869.png?raw=true)
_ UAuraAbilitySystemComponent 中创建 **绑定到多播的事件** 和 **多播回调**
    _ 头文件
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/819264_39018.png?raw=true)
    _ 源文件
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/843744_803675.png?raw=true)
_ 何时调用 UAuraAbilitySystemComponent 中的 绑定到多播的事件： **AbilityActorInfoSet()** 呢？
    _ AAuraCharacterBase 中创建虚函数 `**InitAbilityActorInfo()**`
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/318852_361763.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/254323_105902.png?raw=true)
    _ AAuraCharacter 中重写虚函数 `**InitAbilityActorInfo()**`
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/833787_825036.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/79016_770935.png?raw=true)
    _ AAuraEnemy 中重写虚函数 `**InitAbilityActorInfo()**`
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/905251_910791.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/946149_841551.png?raw=true)
_ 此时拾取物品 会有通知 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/650211_988030.png?raw=true)
_ 资产标签
    _ UAuraAbilitySystemComponent中，回调时，打印接收到的 Tag
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/989108_702706.png?raw=true)
    _ 给 药水和水晶 加上资产标签
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/110496_156670.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/310161_474769.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/995305_808446.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/584120_537870.png?raw=true)
    _ 测试打印Tag名字
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/185715_161684.png?raw=true)
    _ **资产标签不在 这里显示** ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/160865_66875.png?raw=true)
_ 当上面的属性变化时，想 广播发送给WidgetController(因为要根据Tag生成相应的小UI)
    _ 在 UAuraAbilitySystemComponent 中创建广播，并在触发GE的回调时，广播收到的 `**FGameplayTagContainer**` 类型数据
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/379263_96167.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/224020_759775.png?raw=true)
    _ UOverlayWidgetController 中绑定多播，回调使用Lambda表达式
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/680120_355758.png?raw=true)
        _ 若能触发，说明逻辑正常 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/214225_830722.png?raw=true)
_ 创建一个结构体，收到Tag，发送Tag，UI中根据表格中的结构体查找相应信息，读取并调用UI
    _ UOverlayWidgetController 中创建结构体
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/386037_488310.png?raw=true)
    _ UI中创建文件夹，存放UI相关的数据
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/247068_418737.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/216674_492412.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/798105_746811.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/334260_372976.png?raw=true)
    _ 项目设置中 添加Tag
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/645309_792656.png?raw=true)
    _ UOverlayWidgetController 中创建智能指针 保存表格
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/728284_190623.png?raw=true)
    _ **BP_OverlayWidgetController** 中 配置表格
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/459436_32191.png?raw=true)
    _ 配置表格
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/715099_846876.png?raw=true)
    _ 修改GE中的资产标签
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/364497_467285.png?raw=true) ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/358197_287879.png?raw=true) ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/882147_718200.png?raw=true) ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/236974_336495.png?raw=true)
_ UOverlayWidgetController 中创建一个模板函数，根据传入的表格和Tag，找到指定的行结构体并返回
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/682403_4212.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/672234_584217.png?raw=true)
_ 在 UOverlayWidgetController 中创建动态多播，在获取到表格信息时广播到UI
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/619644_606956.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/196999_401152.png?raw=true)
_ 小测试：在你觉得最合适的地方绑定多播，并在屏幕上打印 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/21331_206961.png?raw=true)
    _ 自己尝试一下
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_012/225036_944810.png?raw=true)

___________________________________________________________________________________________

[返回最上面](#处理关键点)
___________________________________________________________________________________________