___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 5.1 PC实现点击移动_参考官方 俯视角游戏模板
___________________________________________________________________________________________
## 处理关键点
1. 了解官方俯视角游戏DS/LS框架下的问题
2. 梳理点击移动的逻辑
___________________________________________________________________________________________

[TOC]

___________________________________________________________________________________________


_ 视频链接
    _ 原理解析: [https://www.bilibili.com/video/BV1JD421E7yC?p=102&vd_source=9e1e64122d802b4f7ab37bd325a89e6c]("https://www.bilibili.com/video/BV1JD421E7yC?p=102&vd_source=9e1e64122d802b4f7ab37bd325a89e6c")
    _ 课程链接: [https://www.bilibili.com/video/BV1JD421E7yC?p=103&vd_source=9e1e64122d802b4f7ab37bd325a89e6c]("https://www.bilibili.com/video/BV1JD421E7yC?p=103&vd_source=9e1e64122d802b4f7ab37bd325a89e6c")
_ AAuraPlayerController中
    _ 头文件中创建几个变量
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/198225_532153.png?raw=true)
        _ `**FVector：CachedDestination目标地点**`
        _ `**float：ShortPressThreshold鼠标 短按/长按 区分的时间阈值**`
        _ `**float：FollowTime鼠标 短按/长按 记录时间**`
        _ `**bool：bAutoRunning是否可以自动奔跑**`
        _ `**bool：bTargeting是否有目标（敌人）**`
        _ `**float：AutoRunAcceptanceRadius与目的地的距离**`
        _ `**组件：Spline样条线组件**`
            _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/389897_312219.png?raw=true)
        _ 配置默认值 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/206031_286271.png?raw=true)
    _ 源文件中
        _ 构造中 创建样条线组件
        _ 鼠标按下时， <font color=#FFAF38>**AbilityInputTagPressed**</font> 函数中，若传进来的tag是LMB的Tag（说明短按下左键），如果 `ThisActor == nullptr` ， `bTargeting=false` ； `ThisActor != nullptr` ， `bTargeting=true` ；此时不是长按的触发时机，所以 `bAutoRunning = false` ；
            _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/298057_721158.png?raw=true)
                _ 之前在勾边时，创建过一个ThisActor指针（指向当前鼠标正在指向的Actor）若该目标没有实现接口，就是nullptr
        _ 鼠标长按时， <font color=#FFAF38>**AbilityInputTagHeld**</font> 函数中，如果传进来的tag不是LMB的Tag（说明不是长按的左键），此时执行检查ASC组件，调用ASC组件中的回调函数（旧逻辑）然后返回；下面是按左键的逻辑，若 `bTargeting == true` 说明左键点击了敌人，此时执行检查ASC组件，调用ASC组件中的回调函数（旧逻辑）然后返回；else说明左键没有点击敌人即 `bTargeting == false` 此处处理的才是长按点击移动的逻辑： `FollowTime+=DeltaTime` 发射一条射线，如果击中物体, `CachedDestination目标地点 = 击中点` ，如果能拿到控制的角色，先计算 <font color=#75C940>**Dir**</font> ，然后 <font color=#FFAF38>**AddMovementInput**</font>
            _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/359080_13488.png?raw=true)
                _ 想要达到，短按左键，自动跑 = true
_ 此时效果gif ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/291019_98446.gif?raw=true)
_ 

___________________________________________________________________________________________

[返回最上面](#Go主菜单)
___________________________________________________________________________________________