___________________________________________________________________________________________
> [!!!!!!!!!!!项目根目录!!!!!!!!!!!](./!!!!!!!!!!!项目目录!!!!!!!!!!!.md)

___________________________________________________________________________________________

# GAS 6.4 当火球发生撞击时产生音效和Niagara粒子，火球飞行时加loop音效绑定到root,持有该音频组件，撞击后停止音效
___________________________________________________________________________________________
## 处理关键点
1. 这里是关键点
2. 这里是关键点
3. 这里是关键点
4. 这里是关键点
5. 这里是关键点
6. 这里是关键点
7. 这里是关键点
8. 这里是关键点
9. 这里是关键点
10. 这里是关键点
___________________________________________________________________________________________

[TOC]

___________________________________________________________________________________________

_ <font color=#DC2D1E>**处理关键点：**</font>
    _ <font color=#DC2D1E>**1.生成音频调用API：**</font> <font color=#FFAF38>**UGameplayStatics::PlaySoundAtLocation**</font> ； <font color=#DC2D1E>**生成音频绑定在目标身上API：**</font> <font color=#FFAF38>**UGameplayStatics::SpawnSoundAttached**</font> <font color=#DC2D1E>**此函数返回一个组件，可以使用**</font> <font color=#DC2D1E>`**.Stop();**`</font> <font color=#DC2D1E>**停止播放**</font>
    _ <font color=#DC2D1E>**2.使用Niagara粒子系统需要引模块"**</font>
    _ <font color=#DC2D1E>**3.生成Niagara粒子调用API：**</font> <font color=#FFAF38>**UNiagaraFunctionLibrary::SpawnSystemAtLocation**</font> ；
    _ <font color=#DC2D1E>**4.重写Destoryed虚函数时，注意!!!要在调用父函数之前写逻辑!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!**</font>
_ 视频链接
    _ 【【AI中字】虚幻5C++教程使用GAS制作RPG游戏（一）_哔哩哔哩】 [https://b23.tv/met5M9E]("https://b23.tv/met5M9E")
_ 使用Niagara粒子系统需要引模块" **Niagara** "
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/771830_320200.png?raw=true)
_ AAuraProjectile 中，创建Niagara粒子组件和音频组件。
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/842440_970317.png?raw=true)
_ 在抛射物组件中，当overlap重叠发生时 <font color=#FFAF38>**UGameplayStatics::PlaySoundAtLocation**</font> ； <font color=#FFAF38>**UNiagaraFunctionLibrary::SpawnSystemAtLocation**</font> ；然后判定是否为权威端，如果是权威端的话 <font color=#FFAF38>**destroy**</font>
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/202593_114076.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/311057_716466.png?raw=true)
_ AAuraProjectile 中重写 <font color=#FFAF38>**Destroyed**</font> 虚函数。
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/363487_418403.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/830318_775130.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/574885_14214.png?raw=true)
    _ <font color=#DC2D1E>**3.重写Destoryed虚函数时，注意!!!要在调用父函数之前写逻辑!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!**</font>
_ 在蓝图中，配置Niagara粒子系统和音频组件。
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/538271_958448.png?raw=true) ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/257771_49378.png?raw=true)
_ 在火球发射时使用动画通知，播放音效，添加动画通知通道
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/855039_360867.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/289995_106200.png?raw=true)
_ 小测试 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/734655_609498.png?raw=true)
    _ 在抛射物 AAuraProjectile 中再添加一个循环声音组件。 <font color=#FFAF38>**Beginplay**</font> 时把它绑定在跟骨骼上。
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/654679_506125.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/901138_592848.png?raw=true)
    _ 因为想删除的话，需要拿到这个函数的返回值是一个 audio component组件。
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/710101_353774.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/142242_475547.png?raw=true)
    _ 当重叠发生时 Overlap的回调函数中需要停止这个循环声音组件
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/771144_179719.png?raw=true)
            _ <font color=#DC2D1E>**如果无法调用，需要引头文件**</font> ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/834248_694298.png?raw=true)
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/254479_528231.png?raw=true)
    _ 蓝图中配置
        _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/219204_594636.png?raw=true)
    _ AAuraProjectile 中，为火球设置生命周期，防止无限存活占用内存，并在 <font color=#FFAF38>**Beginplay**</font> 时设置
        _ 头文件
            _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/755150_728809.png?raw=true)
        _ 源文件
            _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/120834_338967.png?raw=true)
_ 此时，哥布林太矮了打不到，可以等出手位置低的时候攻击。。。 ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/503872_448627.png?raw=true)
    _  ![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_044/4270_513484.png?raw=true)

___________________________________________________________________________________________

[返回最上面](#处理关键点)
___________________________________________________________________________________________