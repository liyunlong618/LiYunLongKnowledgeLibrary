___________________________________________________________________________________________

###### [Go主菜单](../MainMenu.md)

___________________________________________________________________________________________

# GAS 5.7 GA中在服务器端生成火球

___________________________________________________________________________________________

## 处理关键点

1. 只有服务器才能生成火球:

2. GA中,使用API:`GetAvatarActorFromActorInfo` 拿到使用`该GA的Actor`。

3. GA中,使用API:`GetOwningActorFromActorInfo` 获取`Owner`

4. 使用 `GetWorld()->SpawnActorDeferred` `延时生成Actor`(延时生成还需要调用 `FinishSpawning` )

5. GA中通过`WaitGamePlayEvent`,接收事件的Tag,发送时使用`SendGameplayEventToActor`,发送事件Tag

___________________________________________________________________________________________

[TOC]

___________________________________________________________________________________________



___________________________________________________________________________________________


### 视频链接

  - 【【AI中字】虚幻5C++教程使用GAS制作RPG游戏（一）-哔哩哔哩】 https://b23.tv/YGFNaih

  - 【【AI中字】虚幻5C++教程使用GAS制作RPG游戏（一）-哔哩哔哩】 https://b23.tv/8CmnhX9

  - 【【AI中字】虚幻5C++教程使用GAS制作RPG游戏（一）-哔哩哔哩】 https://b23.tv/4G4lRhv

___________________________________________________________________________________________


### UAuraProjectileSpell中,创建抛射物体Class在GA中配置

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/01.png?raw=true)

___________________________________________________________________________________________


### 因为角色的基类中共同继承了接口ICombatInterface,在该接口类中,创建虚函数:获取插槽Location

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/02.png?raw=true)

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/03.png?raw=true)

___________________________________________________________________________________________


### 角色基类中添加一个FName的变量,用来标注要发射的插槽名字,重写接口虚函数,返回该FName的位置

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/04.png?raw=true)

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/05.png?raw=true)

___________________________________________________________________________________________


### 只有服务器才能生成火球:使用API:GetAvatarActorFromActorInfo 拿到使用该GA的Actor。判断该Actor是否实现了接口类,若实现了,获取插槽位置,设置Transform,使用 SpawnActorDeferred 延时生成Actor(延时生成还需要调用 FinishSpawning ),使用API:GetOwningActorFromActorInfo 获取Owner

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/06.png?raw=true)

___________________________________________________________________________________________


### 蓝图中配置

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/07.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/08.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/09.png?raw=true)

___________________________________________________________________________________________


### 在项目设置game play tag里面加入Event.Montage.Tag

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/10.png?raw=true)

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/11.png?raw=true)

___________________________________________________________________________________________


### GA中使用蓝图节点 WaitGamePlayEvent

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/12.png?raw=true)

___________________________________________________________________________________________


### 创建蒙太奇,记得检查插槽

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/13.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/14.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/15.png?raw=true)

___________________________________________________________________________________________


### 创建动画通知,重写函数,使用SendGameplayEventToActor,Tag创建变量,便于在外面设置

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/16.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/17.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/18.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/19.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/20.png?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/21.png?raw=true)

___________________________________________________________________________________________


### 触发时打印测试

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/22.png?raw=true)

  - 改完记得改回来！！！！！
     
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/23.png?raw=true)

___________________________________________________________________________________________


### 测试结果gif,流程:点击鼠标后,播放动画蒙太奇到指定时机发送AnimNotify发送Tag,受到Tag时,屏幕左上角打印（火球暂时还没修改）
 
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/24.gif?raw=true)

___________________________________________________________________________________________


### 小测试:

  
![img](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/25.jpg?raw=true)

![img](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/26.jpg?raw=true)
  
![img](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/27.jpg?raw=true)

![img](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/28.jpg?raw=true)

   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/29.jpg?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/30.jpg?raw=true)
   
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/31.jpg?raw=true)

___________________________________________________________________________________________


### 此时有一个bug点击没有cd,这个先不管,先修正方向
![img](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_037/32.jpg?raw=true)

___________________________________________________________________________________________

[返回最上面](#Go主菜单)
___________________________________________________________________________________________