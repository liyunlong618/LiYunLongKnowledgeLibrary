___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 164 创建 `cue Static` 项目中索引优化cue的路径，在心情文件中并配置；参考lyra在配置文件中修改，RPC最大通信数量为10

___________________________________________________________________________________________

## 处理关键点

1. 在 `DefaultGame.ini` 中手动设置cue的索引路径对大型项目的优化
2. cue激活需要重写的函数和流程
3. 参考 `Lyra` 设置 `最大RPC数量`

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[9. GameplayCue Notify Paths_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=122&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 这一节，我们将着手为技能制作提示（比如生成特效）


------

### 创建一个 `GameplayCueNotify_Static`

  - 在这个技能路径下
>![img](https://api2.mubu.com/v3/document_image/25165450_587edd01-ec2c-45b5-c30f-a81908104130.png)

  - 命名为：***GC_ShockBurst***

>![img](https://api2.mubu.com/v3/document_image/25165450_dba258b4-a19d-4e07-b4d9-5c9a4d3c80f9.png)


------

### 重写 `OnExecute` ，并在角色的位置播放音效

  - 可以使用这个音效
>![img](https://api2.mubu.com/v3/document_image/25165450_bdd7457c-2d59-4620-cf42-6a57b72ec31c.png)

>![img](https://api2.mubu.com/v3/document_image/25165450_39927118-7f52-429a-b9f0-d8b13d222ed9.png)


------

#### 但是缺少一个 `CueTag` 来触发，所以需要创建一个
>![img](https://api2.mubu.com/v3/document_image/25165450_53de3a4a-9acc-479d-f34a-2b32f36360f8.png)


------

#### 项目设置中创建一个，并配置
>![img](https://api2.mubu.com/v3/document_image/25165450_2d08dd2a-a0ba-49df-d509-2cbb86c8a962.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_ee3f784b-8ed5-4545-9745-e41309f4faea.png)


------

### 在激活技能后，触发蒙太奇前，可以调用 `ExecuteGameplaycueOnOwner` 函数来通知 `Cue`
>![img](https://api2.mubu.com/v3/document_image/25165450_f5e8b8e0-6767-48f9-d758-0dbd3ae24750.png)


------

#### 这个函数的Context即使不设置，在触发 `cue` 后 会根据上下文和使用者 `AvatarActor` 设置 `cue` 的 `Owner`
>![img](https://api2.mubu.com/v3/document_image/25165450_5a94e5de-b5ce-436f-c39b-7122d240fb96.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_5ac6fc32-a17d-4928-beb8-bab6eb6df2c7.png)


------

### 运行游戏后会受到一个警告
>![img](https://api2.mubu.com/v3/document_image/25165450_7cdd29ca-a468-4a79-bd30-be2edf562628.png)


------

#### 意思是，当游戏运行时，我们会从整个项目中查找 `GameplayCue` 的 `蓝图类文件` ，大型项目比较费时，建议整合一个大文件夹来单独处理（优化）


------

### 创建 `Cue` 的文件夹

- 在这个路径下
>![img](https://api2.mubu.com/v3/document_image/25165450_db735bd1-cc0c-415c-dbbf-9f1818419f4f.png)


------

#### 将用到的 `Cue` 挪到这个文件夹中
>![img](https://api2.mubu.com/v3/document_image/25165450_1c7edf54-4335-45d4-fea9-e8182fffd29e.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_f3b70df4-9841-4890-ec64-dcb56e7c1a8c.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_49bf6e6d-2941-411a-e632-334ebd790313.png)


------

#### 在 `DefaultGame.ini` 中指定路径
>![img](https://api2.mubu.com/v3/document_image/25165450_872e69b7-05e8-419c-a1f6-1461955f83d3.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_56ba2ffd-c41d-47a6-d9f2-71c75b179ce1.png)

```ini
+GameplayCueNotifyPaths=/Game/Blueprints/Abilitysystem/GameplayCueNotifies
```

- 这里的Game就相当于项目中的Content文件夹
- 也可以指定多个路径，复制这一行然后修改路径即可：`+GameplayCueNotifyPaths=/Game/Blueprints/Abilitysystem/GameplayCueNotifies`


------

### 下面需要检查并修改 `最大RPC更新数量`

  - 每次网络更新可以发送的数量是有限的。我想看看这个限制是多少


------

#### 全局索引 `MaxRPCPerNetUpdate`
>![img](https://api2.mubu.com/v3/document_image/25165450_7172e502-db22-4f2c-8f89-f216bb3d2d70.png)


------

#### 在这里断点，检查运行时， `MaxRPCPerNetUpdate` 这个值被设置为多少
>![img](https://api2.mubu.com/v3/document_image/25165450_8789f5e9-c9de-42ff-a8db-b1daf032f3a8.png)

- 可以看到最大数量限制是 `2`，这是 `可以发送的 RPC 数量` ，每次网络更新可以发送的数量。
>![img](https://api2.mubu.com/v3/document_image/25165450_a64a75e9-dad5-44e8-d4b0-fbd6dbe27e98.png)

- 有点低。我们可以增加到大约 10。lyra 游戏项目将其设置为 10.


------

#### `DefaultEngine.ini` 中修改 `最大RPC更新数量` 为 `10`（参考Lyra设置的，建议不要超过10！）
>![img](https://api2.mubu.com/v3/document_image/25165450_f609f03d-ff3d-4952-b0f0-bce56aeee387.png)


------

#### 在运行就会发现 这个修改为了 `10`
>![img](https://api2.mubu.com/v3/document_image/25165450_b402d376-437c-4a55-e4d0-2e38b23d0c42.png)


------

### 我们每秒可以接收 60 到 100 次网络更新，取决于带宽和游戏中发生的情况。所以，你知道，你不需要超过10个！！


------

### 接下来，可以设置将开始释放闪电的动画调慢一些，混入也慢一些，配合音效
>![img](https://api2.mubu.com/v3/document_image/25165450_ae295957-8284-4788-fadc-af1b4200ac84.png)

___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________