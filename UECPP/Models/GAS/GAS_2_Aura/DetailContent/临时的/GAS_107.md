<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 107 为萨满制作召唤技能(7)恶魔出现的过渡效果；修复爆红GetSetByCallerMagnitude参数处理；内存泄漏：1.WaitGameplayEvent多次触发2.NS粒子没有自动销毁

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[25. Adding Juice with Tweening_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=26&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[26. Enemies Final Polish_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP?p=27&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

------

### 现在召唤恶魔，恶魔就会突然出现，有点突兀，希望加一些过渡效果，如果有从地里爬出来的动画就好了，但是没有的话，这里打算用缩放制作一些小效果


------

### 在恶魔的BeginPlay时添加TimeLine
>![img](https://api2.mubu.com/v3/document_image/25165450_78ec155f-57fe-4bef-9a57-6c917b8129b9.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_820d0657-4ef3-4026-dcae-2f7784a1aad7.png)

------

### 下一节

------

### 下面有一些关于开销问题


------

### 场景中放入8个远程恶魔，开启FPS
>![img](https://api2.mubu.com/v3/document_image/25165450_6ce2d421-198b-4c05-d6eb-9fe12e4f1710.png)
>
>- 会发现场景中的FPS随着释放技能一直在下降
>![img](https://api2.mubu.com/v3/document_image/25165450_bca37052-915f-409d-9bbd-9f7f0c0707d8.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_959a1369-1bf3-49ae-b8c6-c9858bbd00bd.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_cf12164b-ed60-40b2-ffbc-8cd4547fa87e.png)
>- ## 可以判断这是内存泄漏


------

### 1.先检查是否产生了过多的发射物

>- 代码中加入调试命令，检查一下
>![img](https://api2.mubu.com/v3/document_image/25165450_02f6b4a3-4075-4361-c432-a81b4ec48c41.png)


------

#### 会有报错信息
>![img](https://api2.mubu.com/v3/document_image/25165450_c9e81343-399d-4219-8f1d-66a89114d83f.png)


------

#### 先不管红色的，删除掉场景中多余的远程恶魔，只留一只


------

#### 运行测试gif
>![img](https://api2.mubu.com/v3/document_image/25165450_5e845cc3-0ad7-44cb-d7ec-dd520bd2fdda.png)
>
>- 发现叠加似的，越来越多


------

#### 在播放蒙太奇后和收到EventTag后分别打印调试
>![img](https://api2.mubu.com/v3/document_image/25165450_c25e1f60-67cf-40ba-b64b-91d8d9436f82.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_a8f3190d-e7d6-41f5-a02b-da70c5e95b88.png)


------

#### 运行测试gif
>![img](https://api2.mubu.com/v3/document_image/25165450_c71735ce-493d-4e7d-ec7e-9a4cf67526fa.png)
>
>- 看到多个EventTag


------

## 需要将 WaitGameplayEvent 设置为只触发一次
>![img](https://api2.mubu.com/v3/document_image/25165450_dd56fb50-5e24-44e2-c2bc-0f24c8c015ee.png)


------

#### 运行测试gif
>![img](https://api2.mubu.com/v3/document_image/25165450_da384a84-0393-417d-f23b-f962af972344.png)


------

### 继续测试 场景中放入8个远程恶魔，开启FPS
>![img](https://api2.mubu.com/v3/document_image/25165450_2535936c-b0bc-40c1-d369-cfca95302c3a.png)
>
>- 还在下降，但是慢一些了
>![img](https://api2.mubu.com/v3/document_image/25165450_b9eafd82-b150-4f29-af26-ffa575b23efe.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_d34d13cf-59c0-4220-acd7-52d1b5a63ce9.png)


------

## 因为NS粒子没有设置自动销毁，而是永远存在
>![img](https://api2.mubu.com/v3/document_image/25165450_5a406ae0-68a4-4574-b3b4-ffc65bd7d911.png)
>
>- 需要修改为在生命周期结束时自动销毁


------

### 场景中放入多一些远程恶魔测试
>![img](https://api2.mubu.com/v3/document_image/25165450_68cc2701-e531-490f-a1bb-9549556bb9c1.png)




------

### 运行30s，FPS没有变化，说明优化成功

>- 下面这里需要一个加速播放的gif
>
>![img](https://api2.mubu.com/v3/document_image/25165450_2288c3a1-5444-4692-9f2d-ba518b4ff2b7.png)

------

### 下面修复另一个问题，文件爆红

>- 需要chatgpt翻译一下报错的内容
>
>![img](https://api2.mubu.com/v3/document_image/25165450_03f6c60b-89f3-41d5-8087-dbe0350411ff.png)


------

## 我们之前在计算伤害时，在for循环内使用了API GetSetByCallerMagnitude 但是这个函数底层源码有一个检查是否报错的bool，需要关闭，因为如果传入没有的Tag，希望返回0是我们设计的逻辑的一环
>![img](https://api2.mubu.com/v3/document_image/25165450_7ecde157-8873-4d0d-e789-188e7990e2d3.png)


------

#### GetSetByCallerMagnitude 源码
>![img](https://api2.mubu.com/v3/document_image/25165450_bd5c1ac3-28e6-4365-c211-0e2dfc3d59a4.png)


------

#### 修改一下
>![img](https://api2.mubu.com/v3/document_image/25165450_e79dd3e2-02a8-4c74-9cbf-3d45acf7979e.png)


------

### 移除不用的打印节点


------

### 此时运行测试 gif 正常了
>![img](https://api2.mubu.com/v3/document_image/25165450_fce396a4-b26c-4f9e-872d-ae2dc7518da7.png)


------

### 场景中放入三个萨满测试检查FPS gif
>![img](https://api2.mubu.com/v3/document_image/25165450_b2f4c0c1-2967-42db-811a-a9952554ce89.png)


------

### 检查所有的NS看是否自动销毁
>![img](https://api2.mubu.com/v3/document_image/25165450_5ec7febf-61ee-4d0f-faeb-c111d6cc50c2.png)


------

### 接下来我们将制作升级系统，升级以后会有技能点，火球技能也能够升级，请看下集

___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________