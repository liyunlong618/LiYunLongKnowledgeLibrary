<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 081 动画切换混合空间卡顿；使用预设的装饰器(时间限制器)；使用NaviMesh获取导航上的随机点

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[9. Find New Location Around Target_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1JD421E7yC?p=169&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

> ### 现在近战会冲到脸上攻击，远程会站在那里(因为还没写远程逻辑)，
>
> ### 现在希望近战，打一下，围着主角绕着走，而不是傻傻站在原地等待第二下攻击，
>
> ### 所以需要围绕着主角获取一个能够导航到的点，需要用到NaviMesh导航API获取位置

------

### 先处理一个bug：

> - #### #### 近战敌人在从第三个行为树分支切换到第二支时，会有一下明显的卡顿
>
> - #### gif![img](document_image/25165450_b7a26c1d-d1de-4d76-e285-70005d9936c7.png)

### 卡顿解决方法：调整混合空间的动画混合时间

> - #### 需要看一下混合空间Sample Smoothing选项下的Weight Speed
>
>   - 数值越大，混合时间越短
>
>   - 比如说：Weight Speed = 4；那么混合时间就是1/4 = 0.25s
>
> ![img](document_image/25165450_b72e380f-3851-4e81-8a40-0dab0e120873.png)

### 此时效果gif

> ![img](https://api2.mubu.com/v3/document_image/25165450_7ab5e587-6dd9-4c62-aa49-f7ff68472f09.png)

#### 敌人的混合空间都需要设置！

------

### 先取消调试信息

> ![img](https://api2.mubu.com/v3/document_image/25165450_e54b0d13-2b36-41f6-9722-dff670c42c82.png)

------

### 接着处理需求，在蓝图中创建BTTask

------

### 先在黑板中，记录要去的位置

> #### 创建 `Vector` 类型变量，命名为 `MoveToLocation`

### 蓝图创建BTTask

> #### 命名为 `BTT_GoAroundTarget`![img](https://api2.mubu.com/v3/document_image/25165450_a6829cca-0768-411c-8eb2-c7a8c2382491.png)

### 蓝图Task任务中创建设置黑板 Vector 的变量 BlackboardSelect 扣开眼睛，用来设置新的位置

> ![img](https://api2.mubu.com/v3/document_image/25165450_39a457fa-8876-45f5-dfc0-63e927f7c8c1.png)![img](https://api2.mubu.com/v3/document_image/25165450_8729826b-f31c-4cba-a21e-6fde0b1e231d.png)

------

### 那么如何获取player的位置呢？

> #### 需要获取黑板值
>
>-  #### 所以需要新建 `BlackboardSelect` 变量![img](https://api2.mubu.com/v3/document_image/25165450_295ea97e-57a0-459e-c09b-743d0f77f2b2.png)![img](https://api2.mubu.com/v3/document_image/25165450_c4aa55fc-54e5-4d14-c793-f878d2a7f75f.png)
>

------

### 使用Player变量前，需要先判断有效性

> ![img](https://api2.mubu.com/v3/document_image/25165450_15df268c-32c1-4cda-8144-1b27709ffac0.png)

------

### 接下来，将获取距离的半径设为变量，扣开眼睛，这样在行为树中可以直接配置，如果获取成功直接设置黑板中的值，并将获取位置的结果，与任务成功与否，结果映射。

> ![img](https://api2.mubu.com/v3/document_image/25165450_af106dd2-e1c9-4b26-a3ec-a6d657638e38.png)![img](https://api2.mubu.com/v3/document_image/25165450_cd978ab2-2389-4f3e-a966-ed2859616ef0.png)



------

### 获取位置后需要移动到该地点；然后再攻击之后加一个随机的delay

> ![img](https://api2.mubu.com/v3/document_image/25165450_0d1a5505-8638-4ae6-e312-84c6e1fa33f9.png)

------

### 有一个问题，就是下图的第五个节点MoveTo有可能在执行移动的时间比较长(比如说根本到不了，被卡住了等等)那么就需要打断这个任务，防止卡死，需要添加装饰器

> ![](D:\LiYunLong\UnrealProject\GitHub\LiYunLongKnowledgeLibrary\UECPP\Models\GAS\GAS_2_Aura\DetailContent\临时的\2.png)
>
> ### 使用系统写好的预设：时间限制器
>
> - #### 配置时间2秒左右
>
> - #### 自动打断自身
>
> - #### 防止卡死
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_c87427a4-bb81-41bd-834e-c149257cac92.png)
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_4d646c7d-6adb-48c7-e0b8-116655af2a30.png)

------

### 此时效果gif

> #### 敌人会攻击玩自动寻找附近位置，且玩家可以移动![img](https://api2.mubu.com/v3/document_image/25165450_4db78fdf-6071-43ef-e96c-8ce45d0a82ec.png)


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________