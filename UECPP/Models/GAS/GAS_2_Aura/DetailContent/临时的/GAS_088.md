<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 088配置敌人伤害的GE和伤害逻辑；修复敌人攻击Player不显示伤害UI的bug

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>



[6. Causing Melee Damage_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1JD421E7yC?p=180&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 这节我们想给敌人的攻击应用伤害

------

### 敌人攻击的GA中有一个GE的配置

> ![image-20240826094230633](C:\Users\ZGF\AppData\Roaming\Typora\typora-user-images\image-20240826094230633.png)



<details>
<summary>GE_Damage使用了ExecCalc_Damage自定义伤害计算</summary>


>![img](https://api2.mubu.com/v3/document_image/25165450_9b793541-1fd5-4530-c435-1e9fe33e76d0.png)
>
>关键是这里的操作，需要映射一组，键值对![img](https://api2.mubu.com/v3/document_image/25165450_77f4a63d-f6ac-481c-9d84-823accaa8d7e.png)

------

</details>





<details>
<summary>蓝图中对应的操作，了解用就行，因为需要在C++中做，不能在蓝图里</summary>

>![img](https://api2.mubu.com/v3/document_image/25165450_2c9a1c56-4fdc-426d-9c4d-3d48feca9836.png)

------

</details>

------

### 还需要在蓝图中添加一组，伤害和曲线表格的映射

> ![image-20240826094651138](C:\Users\ZGF\AppData\Roaming\Typora\typora-user-images\image-20240826094651138.png)
>
> - ### 我们使用物理伤害，和CT_Damage表格，但是没有伤害的曲线，所以需要创建曲线
>
>   ![img](https://api2.mubu.com/v3/document_image/25165450_5063b17e-7e11-4ff7-c6ab-ffeb4ea002f0.png)

------

### 创建敌人物理伤害曲线，并配置

> - #### 这里使用的数据
>
>   | 等级 | 伤害 |
>   | ---- | ---- |
>   | 1    | 5    |
>   | 40   | 50   |
>
> - #### 曲线自由调整![img](https://api2.mubu.com/v3/document_image/25165450_675c236c-8253-40f0-8c7b-3f9c754e3813.png)

------

### 需要在伤害基类 `UAuraDamageGameplayAbility` 中，创建根据表格映射 `SetByCaller的键值对`

> 步骤：
>
> - 1.创建 `FGameplayEffectSpecHandle`
>
> - 2.遍历伤害列表 `DamageTypes`
>   - 3.遍历中 `绑定SetByCaller` 的 `键值对` ，也就是 `Tag` 和 `float` (取决于 `表格` 和 `等级` )
>
> - 4.最后在蓝图中调用
>
> - ![img](https://api2.mubu.com/v3/document_image/25165450_29327064-4856-4b10-ba97-5f47c205feb0.png)![img](https://api2.mubu.com/v3/document_image/25165450_7d223dbb-739e-4fdf-def1-95fc68dddca0.png)![img](https://api2.mubu.com/v3/document_image/25165450_61259db2-0ae4-4a3a-d20e-5f44c16a6d55.png)

------

### 此时效果gif

> #### 应该可以看到掉血的效果了![img](https://api2.mubu.com/v3/document_image/25165450_ca5ebd29-2598-4cce-d605-04aa604fd837.png)

------

### 将敌人等级改成40

> ![img](https://api2.mubu.com/v3/document_image/25165450_ba36fb81-aa1d-4598-fa6a-cf9bba42f606.png)

------

### 此时再进行测试gif

> ![img](https://api2.mubu.com/v3/document_image/25165450_eb18e009-0fff-4fc7-8d41-1cf367c609f0.png)

------

>## 记得把敌人的等级调回1

------

### 此时有一个bug就是敌人攻击我们并不显示伤害文本

>  #### 原因是这里，如果 `SourceCharacter` 是 `AI` 那他的 `PC` 肯定不是 `AuraPlayerController` 所以这里会失败![img](https://api2.mubu.com/v3/document_image/25165450_3d2cfa31-fe11-4b22-d641-4572eb9350b7.png)
> ## 解决方法：需要增加一种情况

------

### bug修复

> ### 如果 `SourceCharacter` 没有 `PC` 那么检查 `TargetCharacter` 有没有 `PC` ，`有的话就调用` ，当然需要 `先检查SourceCharacter` ，**如果SourceCharacter有PC那么不用执行下面的逻辑了**![img](https://api2.mubu.com/v3/document_image/25165450_597fdb2a-479e-42ad-a0ab-4d96be926dfc.png)

------

### 此时效果GIF
>![img](https://api2.mubu.com/v3/document_image/25165450_79119369-a981-497b-be02-93016abf4ac0.png)


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________