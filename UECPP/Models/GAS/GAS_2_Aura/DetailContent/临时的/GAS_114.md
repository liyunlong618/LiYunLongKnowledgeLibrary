<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 114 蓝图中判断Tag读取广播的结构体设置UI；客户端无法触发添加技能的回调，需要重写父类属性复制回调函数，初始化时广播

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[8. Binding Widget Events to the Ability Info Delegate_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP?p=40&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 接下来需要在蓝图中配置结构体和UI
>![这里是图片](./GAS_114/1.png)


------

### `技能UI` 触发蓝图中的 `WidgetControllerSet` 函数后，设置变量绑定代理

> #### **现在有几个技能就会广播给每个 `技能UI` 几次**
>
> ![这里是图片](./GAS_114/2.png)


------

### 接下来需要让 `技能UI` 识别保存自身数据的结构体，所以需要为每一个UI配置Tag


------

####  `技能UI` 上创建 `InputTag` 变量
>![这里是图片](./GAS_114/3.png)


------

#### 在之前创建的配置技能图标的UI中可以知道每个 `技能UI` 对应着什么输入按键，所以需要在这里创建函数配置
>![这里是图片](./GAS_114/4.png)
>
>### 依次改名![这里是图片](./GAS_114/5.png)


------

##### 创建函数配置，命名为，`SetSpellGlobeInputTags`
>![这里是图片](./GAS_114/6.png)


------

#### 初始化时调用
>![这里是图片](./GAS_114/7.png)


------

####  `技能UI` 中使用API：MachesTag检查两个Tag是否匹配
>![这里是图片](./GAS_114/8.png)


------

##### 如果匹配，调用之前创建的设置技能图标的函数
>![这里是图片](./GAS_114/9.png)


------

##### 将这一大段逻辑折叠为函数命名为，`ReceiveAbilityInfo`
>![这里是图片](./GAS_114/10.png)![这里是图片](./GAS_114/11.png)


------

### 运行测试发现我们还没有技能图标

>#### **因为技能中没有配置技能 `AbilityTag`**![这里是图片](./GAS_114/12.png)![这里是图片](./GAS_114/13.png)


------

### 修复问题，给技能添加 `AbilityTag`
>![这里是图片](./GAS_114/14.png)


------

### 运行发现还是没有技能图标


------

### 断点调试
>![这里是图片](./GAS_114/15.png)


------

#### 我们好像没有设置 `技能UI` 的 `WidgetController` ，所以不会触发 `WidgetControllerSet` 函数


------

### 创建函数设置 `技能UI` 的 `WidgetController`，命名为 `SetGlobeWidgetControllers` ，父层，调用设置 `WidgetController`
>![这里是图片](./GAS_114/16.png)


------

### 此时运行，就可以看到技能图标了
>![这里是图片](./GAS_114/17.png)


------

### 还有一个问题，多人LS模式下，客户端无法显示技能图标

> #### **因为这里的逻辑只在服务器上执行**![这里是图片](./GAS_114/19.png)![这里是图片](./GAS_114/18.png)
>
>   - 因此，我们也需要一种在客启端上广播它的方法，并且有一个很好的简单方法可以做到这一点，一旦我们给出了我们的能力，那么能力系统组件可激活的能力容器就会将其复制为一个复制变量


------

## GAS的核心设计是以网络安全性为优先的。`只有服务器端代码可以直接授予或修改能力!!!!!!!!!!!!`

## 这是为了防止客户端直接操纵能力，例如通过修改客户端代码进行作弊。


------

### 可以搜索源码 `GetActivatablAbilities`

>   - 可以看到这是一个虚函数，可以子类重写![img](https://api2.mubu.com/v3/document_image/25165450_8c6c9c1e-6d8f-4ef6-dd3c-f82c15a68700.png)![img](https://api2.mubu.com/v3/document_image/25165450_db4a1574-631e-476d-d7df-177c2766fbb5.png)![img](https://api2.mubu.com/v3/document_image/25165450_6192670e-1347-4d45-e238-607e288aafae.png)
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_ad439e8a-4866-4ae9-93c9-b412d46fc631.png)


------

### 重写虚函数 `OnRep ActivateAbilities`
>![img](https://api2.mubu.com/v3/document_image/25165450_c16312ef-8411-4d28-f99c-4dc1cc70afd5.png)
>
>#### **这样带来的后果就是每次复制都会广播数据，但我们只想在第一复制的时候也就是初始化时广播**
>
>![img](https://api2.mubu.com/v3/document_image/25165450_a299d847-2342-4773-868b-3756819fd839.png)


------

### 需要判断状态，限定一下，只有当没有被广播时，才可以广播，并在广播后设置 bool = false

> #### **因为这里的逻辑，在客户端。而且因为客户端不会走之前的逻辑，而是走这里的逻辑，且第一次走到这里时肯定为false，所以会按照设计执行初始化**
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_b5b92d5a-4d03-47f3-cb74-8b6227847978.png)


------

### 运行测试客户端也可以看到技能图标
>![img](https://api2.mubu.com/v3/document_image/25165450_22720415-bff8-4e17-d7cb-5f5edfd2df91.png)


------

### 因为我们是动态配置的，所以修改GA的InputTag，也会触发UI上的变化


------

#### 改一下试试
>![img](https://api2.mubu.com/v3/document_image/25165450_0257824e-bf01-4764-fb7f-b1da1e2f898e.png)![img](https://api2.mubu.com/v3/document_image/25165450_ebdd3cb0-4c75-4d1f-edf1-ba96562e8b71.png)
___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________