___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 136 创建技能状态和类型的Tag标记技能，并在(初始化) `GiveAbility` 时赋予 `DynamicAbilityTags` 的Tag；根据技能状态Tag，在UI中使用不同显示策略

___________________________________________________________________________________________

## 处理关键点

1. 检查和使用 `GA` 中的 `DynamicAbilityTags` 携带的信息


___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[12. Ability Status and Type_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=79&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[13. Showing Abilities in the Spell Tree_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=80&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 先制定一下技能状态和类型
>![img](https://api2.mubu.com/v3/document_image/25165450_d9bf130e-836a-4742-8716-cf8ffd6d105d.png)


------

### 目前我们有三种技能

  - 分别是：

    - 攻击

    - 萨满

    - 受击
>![img](https://api2.mubu.com/v3/document_image/25165450_f4ddcffe-b125-42cf-a14d-1d40f342c9cd.png)

  - 创建一个这个
>![img](https://api2.mubu.com/v3/document_image/25165450_f55d8024-8f2d-4b8e-a596-7fa0988987c2.png)


------

### 创建状态和类型

  - 技能状态

    - `Abilities_Status_Locked`

    - `Abilities_Status_Eligible`

    - `Abilities_Status_Unlocked`

    - `Abilities_Status_Equipped`
  - 技能类型

    - `Abilities_Type_Offensive`

    - `Abilities_Type_Passive`

    - `Abilities_Type_None`
>![img](https://api2.mubu.com/v3/document_image/25165450_563a24de-7b1a-423a-8d45-487656081408.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_09838140-bd59-491a-e304-2fd2b6f5905b.png)


------

### 之前在我们给予技能时，也给予了技能动态标签DynamicAbilityTags
>![img](https://api2.mubu.com/v3/document_image/25165450_db3f47b4-9785-4680-82e6-2130ef75cae4.png)


------

### 我们也在给与技能时，给与技能状态（我理解是临时逻辑）


------

#### 还需要一个根据FGmaplayAbilitySpec查找并返回对应的状态的函数

  - 命名为，`GetStatusFromSpec`
  - 遍历技能中的动态标签，如果包含技能状态Tag就返回该Tag
>![img](https://api2.mubu.com/v3/document_image/25165450_6b7904de-51db-465e-b8f1-bf90a9c45399.png)


------

### 下一节


------

### 在主动技能和被动技能树中，每一个技能图标需要知道自己是什么技能的技能球，所以每一个技能球需要一个 `AbilityTag` 的标签
>![img](https://api2.mubu.com/v3/document_image/25165450_de2d1112-8dd9-4f7a-c48f-d2906fc54ac3.png)


------

#### 创建 `AbilityTag` 的变量
>![img](https://api2.mubu.com/v3/document_image/25165450_26439985-eee9-4064-e8d4-2f6fe8063564.png)


------

#### 为技能球配置 `AbilityTag`
>![img](https://api2.mubu.com/v3/document_image/25165450_c819281c-589d-4bf5-a0e0-a4b009125777.png)


------

### 为主动技能树和被动技能树设置WidgetController
>![img](https://api2.mubu.com/v3/document_image/25165450_352b10fe-1989-4964-e05f-828a7e0a59ee.png)


------

#### 里面的技能球也需要设置WidgetController
>![img](https://api2.mubu.com/v3/document_image/25165450_d31aabbb-bdc9-4797-9056-be8fa8a89d65.png)


------

### 在技能球中需要根据技能的状态判断显示技能详细程度，所以 `技能信息结构体` 也需要加入状态Tag `StatusTag`
>![img](https://api2.mubu.com/v3/document_image/25165450_ce088b54-9808-4983-990c-9a112245d369.png)
>![img](https://api2.mubu.com/v3/document_image/5a302a53-2fda-4e29-ae59-223b7fd91497-25165450.jpg)


------

### 但是状态Tag `StatusTag` 不是在蓝图中配置的，而是在给予技能时配置，所以需要在广播技能信息结构体时设置技能信息结构体的 `StatusTag`
>![img](https://api2.mubu.com/v3/document_image/25165450_aadbc7e3-7740-4c4a-9be1-504e476d7c77.png)


------

#### 先测试打印一下能不能拿到
>![img](https://api2.mubu.com/v3/document_image/25165450_b97becae-40c3-4396-96c2-8e5e3cca76a8.png)


------

#### 然后根据状态类型，实施不同的策略逻辑
>![img](https://api2.mubu.com/v3/document_image/25165450_7969be1d-13ee-4c46-fb34-ab361022c407.png)


------

### 将主动技能树中的第一列第三个设置为火球的技能Tag，测试一下
>![img](https://api2.mubu.com/v3/document_image/25165450_594213fe-a065-4380-9eca-74ac9e9743c4.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_810c09f5-8686-4deb-857b-dc0da554fa16.png)


------

#### 代码中修改该技能的状态，再测
>![img](https://api2.mubu.com/v3/document_image/25165450_9f72c83a-6a25-45d4-941e-229de32deff9.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_eb71ae96-9d3a-410f-8944-53310dbbe00f.png)


------

#### 测试完记得调回装备
>![img](https://api2.mubu.com/v3/document_image/25165450_43dcba95-1b3a-44c3-c39f-ba77a8886d9e.png)


------

### 这个时候运行游戏后退出，有一个报错gif
>![img](https://api2.mubu.com/v3/document_image/25165450_daaa4b65-b9e9-4632-b34b-adcaab6c6b65.png)


------

#### 因为运行时，设置输入模式时，有可能拿不到PC
>![img](https://api2.mubu.com/v3/document_image/25165450_d5f83921-f0be-4e4f-cbff-072551b521a0.png)

- 判断一下有效性即可


------

### 此时运行关闭，无报错gif
>![img](https://api2.mubu.com/v3/document_image/25165450_2846748e-a18a-406d-dbe6-9283e3eec40d.png)


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________