___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 165 创建和使用 `GameplayCueNotify_Actor` 生成绑定特效和音效；给NS传参

___________________________________________________________________________________________

## 处理关键点

1. `GameplayCueNotify_Actor` 的重写函数中 `OnActive` 和 `WhileActive`  的区别？
2. `GameplayCueNotify_Static` 和 `GameplayCueNotify_Actor`的区别？

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[10. Gameplay Cue Notify Actor_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=123&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 上一节，我们给Cue制定了路径位置
>![img](https://api2.mubu.com/v3/document_image/25165450_45bd80d5-b7af-4e83-f1db-861c8c2109a6.png)


------

### 关于 `GameplayCueNotify_Static` 是不实例化的，被视为静态函数库上的静态函数调用。

  - 例如，游戏提示静态通知是对类默认对象进行操作的 `GameplayCueNotify_Static` 。因此，当我们执行 `GameplayCueNotify_Static` 时，不会生成任何实例


------

### 我们要创建另一种Cue，在调用时，会创建该类的实例，也就是 `GameplayCueNotify_Actor`

  - 如果需要某种循环声音或者需要保留的尼亚加拉系统时使用

  - 类似于 `Actor` ，也有构造，和事件

  - 在类默认设置中，有一个 `CueTag` 可以配置
>![img](https://api2.mubu.com/v3/document_image/25165450_b0d6e895-013f-44bc-ccae-f8d98486de50.png)

  - 可以设置，当Remove时自动销毁，否则，如果它没有被销毁，后续执行此游戏提示的调用将无法工作
>![img](https://api2.mubu.com/v3/document_image/25165450_156b4cc5-8ad3-49be-c24a-e2f644316f2e.png)

  - 这个类中有两个可供重写的方便函数 `OnActive` 和 `WhileActive` 

    - `OnActive`
      - 只有当客户端 `见证` 激活时才生效

    - `WhileActive`
      - 客户端 `见不见证` 激活时都生效

    - 这两个函数
>![img](https://api2.mubu.com/v3/document_image/25165450_e5c4eed2-7cf1-45e2-ecc7-2075dc481177.png)

    - 区别的场景举例：比如A释放两个技能一个 `OnActive` 一个 `WhileActive` ，此时B加入游戏，B没有看到激活的瞬间，那么B只能看到 `WhileActive` 的技能

-  `OnRemove` 函数，当移除时触发

>![img](https://api2.mubu.com/v3/document_image/25165450_30db55f0-3b90-40c3-a611-0d8281e0d0e8.png)

  - 可以通过调用传递参数（不传递没参数！）
>![img](https://api2.mubu.com/v3/document_image/25165450_d1d15f4d-20b9-4c87-d9a9-26b00b207ba9.png)


------

### 添加新的Loop使用的Tag
>![img](https://api2.mubu.com/v3/document_image/25165450_0b2abccd-8a30-4a2d-a182-9fa431feb149.png)


------

### 创建 `GameplayCueNotify_Actor`

  - 命名为：`GC_ShockLoop`

>![img](https://api2.mubu.com/v3/document_image/25165450_18205b9e-3347-485f-87c6-958eb5529bea.png)


------

#### 设置，当Remove时自动销毁，否则，如果它没有被销毁，后续执行此游戏提示的调用将无法工作
>![img](https://api2.mubu.com/v3/document_image/25165450_156b4cc5-8ad3-49be-c24a-e2f644316f2e.png)


------

### 重写 `WhileActive` 函数
>![img](https://api2.mubu.com/v3/document_image/25165450_a9c98819-2082-44c7-fa72-e8dc175cca18.png)


------

### 在开始闪电技能Loop后，调用 `AddGameplayCueOnActor(Looping)` 函数传参
>![img](https://api2.mubu.com/v3/document_image/25165450_53adf3ef-1072-4ef9-e917-069c70d024dc.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_260b64fc-1bf7-475e-abe1-614cf5bee293.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_cb012d37-c046-405e-f3b2-b958c792b86c.png)


------

#### 可以看到即使没有给任何的参数，也可以知道触发Cue的 `MyTarget` 也就是Cue的所有者


------

#### 但是问题是只可以触发一次打印

  - 因为没有移除该 `CueTag`


------

#### 技能结束时，移除该 `CueTag`
>![img](https://api2.mubu.com/v3/document_image/25165450_b3a0e565-8e0a-4da6-b569-45e530a9c200.png)


------

### 运行测试，这下可以重复打印了


------

### 重写函数 `OnRemove`
>![img](https://api2.mubu.com/v3/document_image/25165450_f62cfac8-dd17-469c-bf21-0a4bfae0c42e.png)


------

### 这里有一个问题：第一次按下然后松开技能正常，第二次没有打印OnRemove函数中的字符串

  - 因为没有勾选自动销毁，这样就会占用之前的Tag名额，导致无法再次调用

>![img](https://api2.mubu.com/v3/document_image/25165450_bf9995f0-f5c4-417c-8577-b151dfba1d13.png)


------

### 接下来想看到，闪电的电束


------

#### 移除打印节点，使用节点 `SpawnSystemAttached` 但是需要一个绑定到的组件，需要传递参数进来
>![img](https://api2.mubu.com/v3/document_image/25165450_d100967f-b24a-4304-8a09-721860a67e2b.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_e1790161-a081-49e9-fc35-7c3ece8780ac.png)


------

#### 我们需要在接口中创建一个函数，返回武器的组件（因为需要从武器的插槽发射射线，所以需要武器组件）


------

##### 接口中，创建获取武器组件的函数
>![img](https://api2.mubu.com/v3/document_image/25165450_7c6cca47-7758-418e-f6f7-f1959216fec2.png)


------

##### 角色基类中重写
>![img](https://api2.mubu.com/v3/document_image/25165450_5d946fb8-b91d-4225-869c-6c4faf39748a.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_3c0bd7be-5bdf-46e9-890d-4912ea707b2a.png)


------

#### 在蓝图中调用接口函数，然后给 `Cue` `Actor` 传参
>![img](https://api2.mubu.com/v3/document_image/25165450_a73d2711-7874-4994-afd8-ba31bb8551f9.png)


------

#### 要使用武器的插槽
>![img](https://api2.mubu.com/v3/document_image/25165450_ba15bb11-1ec5-4820-9522-53c0ec56691e.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_dcfc8e48-9d43-4210-f509-0909efcecd35.png)


------

#### 但是会有一个问题，这个组件需要GC，所以需要手动释放


------

##### 蓝图中创建变量记录NS组件然后在移除Cue时销毁这个组件
>![img](https://api2.mubu.com/v3/document_image/25165450_f5e6d5d7-32bf-41a2-a86d-d585f091de7d.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_f44cfb57-dda2-44f4-bd84-db451fec6fe9.png)


------

#### 而且这个NS需要传参
>![img](https://api2.mubu.com/v3/document_image/25165450_cd4c4b44-6cf7-4219-b3b0-3a2fda620702.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_4bccc16f-c8bf-41ee-d6ba-fb9b8700fb20.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_c9a39416-b98e-427a-e1e9-29ae023a9a8b.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_1a9deed1-9379-4740-c08d-50b9a151b7af.png)


------

### 运行测试gif
>![img](https://api2.mubu.com/v3/document_image/25165450_6abdcff6-2f19-4292-b407-7c77efb5c4f6.png)

- 有一个问题是当我们点击墙之类的，会穿过墙，这个后面处理

___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________