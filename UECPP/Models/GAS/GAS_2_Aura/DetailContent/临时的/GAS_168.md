___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 168 处理闪电技能链式伤害的首个目标，射线检测阻挡的目标，播放声音，释放技能后取消目标选择

___________________________________________________________________________________________

## 处理关键点

1. 代码中使用射线检测

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[13. First Trace Target_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP?spm_id_from=333.788.videopod.episodes&vd_source=9e1e64122d802b4f7ab37bd325a89e6c&p=126)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 下面想处理一种技能情况：当释放技能后，假如，技能路线上有别的敌人，闪电技能应该会被挡住，然后击中前面被挡住的单位（需要射线检测）
>![img](https://api2.mubu.com/v3/document_image/25165450_8a145f34-5576-4eb8-fabc-ff14ea7f22cf.png)

- 现在不会被挡住
>![img](https://api2.mubu.com/v3/document_image/25165450_262dca69-34b3-4b3d-f3af-4ed267795a71.png)


------

### 除此之外，当我们对一个目标释放技能时，希望根据技能等级，链接附近的多个单位，造成链式伤害


------

### 我们需要记录一下，我们要攻击的首个目标（需要在代码中完成）


------

#### 创建函数，蓝图中调用

  - `TraceFirstTarget`

>![img](https://api2.mubu.com/v3/document_image/25165450_bd5bba5a-9ddf-41c7-d85c-a5dd3c7a3441.png)


------

#### 函数体中使用单目标胶囊体检测 `SphereTraceSingle`

>![img](https://api2.mubu.com/v3/document_image/25165450_e3a96f3f-e62d-4d54-e8af-c8cd68cba879.png)

  - 如果命中了检测，设置Actor和Location
>![img](https://api2.mubu.com/v3/document_image/25165450_5a033d6d-deb6-4eaf-8d95-65a950b6a8af.png)


------

#### 蓝图中调用 `TraceFirstTarget`
>![img](https://api2.mubu.com/v3/document_image/25165450_d0fd02ac-3469-4d11-d7c6-91fef3ada70d.png)


------

#### 因为之前使用的这个 `MouseHitLocation` ，这里修改变量后，会影响到 `生成闪电到目标` 的逻辑
>![img](https://api2.mubu.com/v3/document_image/25165450_6acc082e-161f-42a7-90c0-d810fcfb809c.png)


------

##### 运行测试
>![img](https://api2.mubu.com/v3/document_image/25165450_c34a8199-9696-404c-fe3a-d7ae65c303cc.png)


------

#### 测试完关闭Debug调试
>![img](https://api2.mubu.com/v3/document_image/25165450_0a9bea64-d1dd-496e-fd0e-16297e8f0583.png)


------

##### 运行测试
>![img](https://api2.mubu.com/v3/document_image/25165450_c436e0cd-b37a-4f2e-8290-b980c1ecfed0.png)


------

### 接下来我们需要创建一个 函数（作为队列） 来操作对目标对象生成闪电Cue


------

#### 在设置了第一个目标之后来处理 `队列`


------

#### 需要为每一个目标配置这些参数，同时将要传递给Cue的参数保存为变量
>![img](https://api2.mubu.com/v3/document_image/25165450_5071422a-31de-41eb-ae01-76c9e19e4004.png)

- 将要传递给Cue的参数保存为变量
>![img](https://api2.mubu.com/v3/document_image/25165450_4e173c87-1f46-48df-8417-50bb9e2cf7d2.png)


------

#### 接下来需要查看，集中的目标是否实现了战斗接口
>![img](https://api2.mubu.com/v3/document_image/25165450_209ba92f-46cb-4003-bdba-02d60c3054a5.png)


------

#### 将Cue的目标设为变量
>![img](https://api2.mubu.com/v3/document_image/25165450_68b14bae-5d11-4e17-b957-f9aac0d7c213.png)


------

#### 如果目标实现了接口，就可以以目标为圆心链接到别的敌人，所以使用目标为Target，如果没有，（说明不是攻击敌人）就使用玩家作为Target添加Cue
>![img](https://api2.mubu.com/v3/document_image/25165450_d9d622cd-479b-4b4d-f9b1-4c4b3270f111.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_b534587e-452e-4d46-f0ac-a0dab3ab292a.png)


------

#### ***GC_ShockLoop*** 中，因为参数中有传递 `SoureObject` 所以，需要判断类型

- 存为变量
>![img](https://api2.mubu.com/v3/document_image/25165450_7b2efe89-cde7-4b7a-f9bd-c2f4dc8e3a26.png)


------

#### 因为我们之前时使用 MouseHitActor 作为 SourceObject 传入，所以可以通过在 `Cue` 中判断目标是否实现战斗接口，来判断是否攻击到敌人
>![img](https://api2.mubu.com/v3/document_image/25165450_c6eca1f3-6c4a-44fb-d542-d57fbb529302.png)


------

##### 生成NS之后，判断，如果为false，说明打的不是敌人，是墙面，这个时候直接设置NS参数即可
>![img](https://api2.mubu.com/v3/document_image/25165450_b447446e-a057-48e5-d976-bb359d9f764d.png)


------

##### 如果为true说明打的是敌人，需要使用敌人的位置传入NS
>![img](https://api2.mubu.com/v3/document_image/25165450_1c74082c-004e-4f1c-a2be-a5fed83a3c44.png)


------

#### 最后播放声音
>![img](https://api2.mubu.com/v3/document_image/25165450_67cbc1d1-883b-4be7-aaea-47efc15adfcc.png)


------

### 我们之前只是添加了目标，还没有移除
>![img](https://api2.mubu.com/v3/document_image/25165450_75d0bd7a-925a-43c8-8373-d65ccaad65cc.png)


------

#### 结束技能时移除


------

##### 需要记录目标是否实现了接口，如果实现了就需要移除目标
>![img](https://api2.mubu.com/v3/document_image/25165450_1b2cf683-ddcd-4633-daa1-9a361e5aa558.png)
>![img](https://api2.mubu.com/v3/document_image/25165450_8f322057-aa7e-4109-e99c-2d4f1ecc5f50.png)

- 记录bool变量

  - `FirstTargetlmplementsInterface`


------

##### 结束技能时根据目标是否实现了接口，执行不同移除策略
>![img](https://api2.mubu.com/v3/document_image/25165450_39ac0688-1a7c-467e-cbd4-0c232a8e4e22.png)


------

### 运行测试gif：打完a打b，可以取消a
>![img](https://api2.mubu.com/v3/document_image/25165450_9dd00835-8d6d-4e06-9511-c0707c6b6839.png)


------

### 下一节，计算 要 链式攻击的相邻目标


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________