<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 125 重构接口GetCharacterLevel函数相关逻辑；处理升级触发逻辑

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[11. Level Up Interface Function_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=57&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[12. Leveling Up_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=58&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________


### 希望可以修改旧的 `ICombatInteraction` 中的 `GetPlayerLevel` 函数，也为静态，和下面的函数一样，下面是修改的一系列重构

>![img](https://api2.mubu.com/v3/document_image/25165450_99d9ae2b-958a-4d07-ce16-4b48602d1c8e.png)![img](https://api2.mubu.com/v3/document_image/25165450_b1bbdd42-5714-40d4-ad3c-9da3864c362f.png)

------

### 修改接口函数导致的重构

------

#### 先是函数改名

>![img](https://api2.mubu.com/v3/document_image/25165450_569136ee-7b86-4570-af50-69940801aa77.png)![img](https://api2.mubu.com/v3/document_image/25165450_b3263d6d-5c2c-47d1-8272-6c6edafb1a43.png)![img](https://api2.mubu.com/v3/document_image/25165450_4415940a-b5fc-44a2-a5c0-bdc4f7a739f0.png)![img](https://api2.mubu.com/v3/document_image/25165450_544cee5a-2d72-4d73-a639-122fa98056a1.png)

------

#### 重构调用处的逻辑，注意不是1.f！

>![img](https://api2.mubu.com/v3/document_image/25165450_8ccaa57d-1007-475d-d877-92cfb35cb2bd.png)![img](https://api2.mubu.com/v3/document_image/25165450_3e3aa713-f96c-442f-9da1-61d8de6b5cd9.png)![img](https://api2.mubu.com/v3/document_image/25165450_49a4f652-67f4-42a3-a72b-1cc4672ff0de.png)![img](https://api2.mubu.com/v3/document_image/25165450_eddf62bc-5b0a-4d78-fe34-5e8c1abe88b2.png)![img](https://api2.mubu.com/v3/document_image/25165450_f5912347-c5bb-42b6-e936-345c044b8616.png)![img](https://api2.mubu.com/v3/document_image/25165450_23c1dff2-8181-499c-8e1a-85d0c08f4bf5.png)

------

#### 最后一个报错

> ![img](https://api2.mubu.com/v3/document_image/25165450_5af556e3-f044-4238-c7c3-196bd3352374.png)
>
>   - #### **显示：链接器错误，函数已定义**

------

## 当我们在接口中，声明了一个蓝图重写事件时，反射系统会帮我们生成函数的定义，我们只能使用反射生成的定义，如果我们自己写了，就会发生重复定义的报错

>![img](https://api2.mubu.com/v3/document_image/25165450_0247de9f-a06c-430b-e53a-5c83e822afc1.png)

------

### 下面我们将处理升级

------

### 玩家接口中创建升级函数，命名为，`LevelUp`

>![img](https://api2.mubu.com/v3/document_image/25165450_40eb9dea-286e-4023-d84a-5f2e43e0cfc1.png)![img](https://api2.mubu.com/v3/document_image/25165450_76d59e2e-0843-4863-cb37-1d66fbe1dbd6.png)![img](https://api2.mubu.com/v3/document_image/25165450_02992c6f-8dd3-4620-d604-b0af771a5bdf.png)

------

### 下一节我们将在AS中处理升级相关的逻辑，也就是这里

>![img](https://api2.mubu.com/v3/document_image/25165450_1e30f46d-c674-4d32-d56d-e881f488e401.png)

------

### 下一节


------

### AS中 `经验值增加` 需要 触发 `升级` 事件

> - #### **升级需要获取XP然后计算**

------

#### 在玩家接口中创建 `获取XP` 的函数，玩家基类重写

>![img](https://api2.mubu.com/v3/document_image/25165450_7d89f57f-6876-4e8d-80b8-d79ca167b8d6.png)![img](https://api2.mubu.com/v3/document_image/25165450_3fac4615-d449-48d7-b2dc-b7fd24315a9a.png)![img](https://api2.mubu.com/v3/document_image/25165450_50b8ecab-7f62-4900-cf27-b58fdee60bd6.png)

------

###  我们的新等级怎么获取？需要创建接口函数

>![img](https://api2.mubu.com/v3/document_image/25165450_a3ae486f-0b94-467d-b58a-375ee5ec81fa.png)

------

#### 在玩家接口中创建 `根据传入的XP查找并返回对应等级` 的函数，玩家基类重写

>![img](https://api2.mubu.com/v3/document_image/25165450_4edac9af-b196-4ebe-a148-c2651b06f157.png)![img](https://api2.mubu.com/v3/document_image/25165450_5c4ccd5c-ea28-4767-9a2d-a2e62bbb157d.png)

------

#### 计算获取新的等级

>![img](https://api2.mubu.com/v3/document_image/25165450_ea8a7283-77ef-4678-c5b1-76e2a763e913.png)

------

### 判断，当 `新的等级 - 旧的等级 大于 1` ，说明需要调用升级的函数

>![img](https://api2.mubu.com/v3/document_image/25165450_05a2457f-757f-4c8d-a212-8039c98197c3.png)

------

### 我们需要梳理一下，升级都需要处理的逻辑

>   - #### **获取属性点**
>
>   - #### **获取技能点**
>
>   - #### **需要增加**
>
>     - **等级**
>
>     - **属性点**
>
>     - **技能点**
>
>   - #### **将血量和蓝量增加到上限(也就是满血满蓝)**
>
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_febffc83-762d-4338-8ecb-92a9050b58e9.png)

------

### 玩家接口中创建对应的函数

>![img](https://api2.mubu.com/v3/document_image/25165450_ebad3a80-c5a0-4c48-966f-e85fd0b1da79.png)![img](https://api2.mubu.com/v3/document_image/25165450_c8916ba3-f704-42eb-f2f4-511119438ae3.png)![img](https://api2.mubu.com/v3/document_image/25165450_d68d676f-8d57-457d-c75e-70febe9966a8.png)![img](https://api2.mubu.com/v3/document_image/25165450_a1fe4fb9-bce1-4c7c-b60d-8f29933cad7b.png)![img](https://api2.mubu.com/v3/document_image/25165450_a007e209-5a6b-4dcc-a474-3fd39baf2fa3.png)

------

### AS中根据之前梳理的几种逻辑，调用逻辑

>![img](https://api2.mubu.com/v3/document_image/25165450_b51945ad-4978-405a-daa1-196c341c9a12.png)![img](https://api2.mubu.com/v3/document_image/25165450_f684f3cc-05fb-40ba-8517-3eb6ac007d75.png)
>
>**66节**![img](https://api2.mubu.com/v3/document_image/25165450_3d1cbce3-b7eb-439a-9eb0-d9c26b616b79.png)

------

### 现在升级部分的逻辑处理有些长，实现功能更多的就是通过调用多个接口的方式，后续可能会重构一下。


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________