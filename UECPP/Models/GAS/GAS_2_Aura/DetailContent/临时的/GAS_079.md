<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 079 行为树中不同敌人执行不同分支；使用装饰器

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[7. Behavior Tree Decorators_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1JD421E7yC?p=167&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 使用 装饰器 (类似于 if 语句)

> #### 条件基于黑板值![img](https://api2.mubu.com/v3/document_image/25165450_b0711a6c-da6b-4c3f-ee37-c79c8f84b839.png)

------

### 行为树节点等级

> ![img](https://api2.mubu.com/v3/document_image/25165450_5a227b2b-25ae-425e-aa62-dd6e0ae9389a.png)

------

### 行为树中创建装饰器，当目标被设置时，执行下面的逻辑

> ![img](https://api2.mubu.com/v3/document_image/25165450_c9a6fd89-ad3c-4d65-a6de-31f9223e18fb.png)

------

### 下面想让敌人对受击作出反应

> - ### 黑板中创建受击的bool
>
>   - #### 命名为 HitReacting，默认为 false![img](https://api2.mubu.com/v3/document_image/25165450_b2d0da88-9b24-40c7-cfd4-78f97408b019.png)
>
> - #### 接下来去敌人中设置
>
>   - #### 设置初始值 为 false
>
>   - #### 受到攻击后 设为 true
>
>     - 有一个受击的回调函数 HitReactTagChanged ，在这里处理
>
>   - #### 确保 敌人的 `AIController` 已经被设置
>
>     ![img](https://api2.mubu.com/v3/document_image/25165450_efae8f82-4c69-45b3-b9dd-8c850562be81.png)
>
>     ![img](https://api2.mubu.com/v3/document_image/25165450_b7a27b1a-d225-483f-d600-56442b01355b.png)
>
>     ![img](https://api2.mubu.com/v3/document_image/25165450_4e4bce20-9c56-49ff-e052-617eab2c6adb.png)

------

### 行为树中，添加装饰器，如果受击状态，需要打断自身并返回失败

> - #### 如果命中反应变为真，我们在这里进行的任何节点都将停止
>
> - #### 只有该 bool == false 时，才会执行下面的节点；否则失败返回![img](https://api2.mubu.com/v3/document_image/25165450_84e8b733-78db-446c-e2cb-c90277b1b639.png)

------

### 接下来我们可以开始思考

> - 如何让敌人靠近角色
>
> - 并攻击角色。

------

### 接下来想要根据敌人的种类执行不同的逻辑

> - 远程敌人
>
> - 近战敌人
>
> - 所以需要一个黑板中的bool值来判断，敌人是否为 近战角色

------

### 黑板中创建 bool 变量，判断是否为远程攻击者

> #### 命名为 `RangedAttacker`![img](https://api2.mubu.com/v3/document_image/25165450_6a144508-637f-49f2-e1bd-b6abddbb5e56.png)

------

### 创建不同类型敌人的行为树分支

> #### 因为上级是select节点，所以只会选择一个执行![img](https://api2.mubu.com/v3/document_image/25165450_47c67336-363b-4beb-96a9-6e3e99550aee.png)

------

### 先在C++敌人基类中PossessedBy时，设置黑板中的 bool 敌人的类型

> #### 这里游侠和元素师都是远程，所以判断是否为近战角色，直接将结果作为bool传入黑板![img](https://api2.mubu.com/v3/document_image/25165450_e07ce330-0dce-4781-99c6-b634ba73f3df.png)

------

### 行为树中设置是否为远程

> #### 只有当设置为 远程bool RangedAttacker == true 时才会执行下面的逻辑![img](https://api2.mubu.com/v3/document_image/25165450_32129c80-9e56-49c6-f3d8-5c9113d57e99.png)

------

### 行为树中，设置，当敌人距离小于Distance，进行近战攻击

> - ### 浮点型float黑板值可以设置：
>
>   | 浮点型float黑板值装饰器 设置打断条件 | 翻译       |
>   | ------------------------------------ | ---------- |
>   | Is Equal To                          | 等于       |
>   | Is Not Equal To                      | 不等于     |
>   | Is Less Than                         | 小于       |
>   | Is Less Than Or Equal To             | 小于或等于 |
>   | Is Greater Than                      | 大于       |
>   | Is Greater Than Or Equal To          | 大于或等于 |
>
> - #### 距离小于500时，激活下面的节点![img](https://api2.mubu.com/v3/document_image/25165450_b5f08fcd-ff53-46eb-8ec3-b8aff2086e22.png)

------

### 接着来写移动的逻辑

> - 移动到离目标50m远就停止
>
> - 移动前加个0.5秒的随机Delay
>
> - 如果足够远就停止打断自身(使用装饰器)
>
> - 如果足够近也希望停止同时断掉自身逻辑，这样就可以去中间的战斗分支
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_5e710085-e0f0-4f51-d4a0-74e861ff0e22.png)
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_bdad96da-f49b-43c8-b063-7935a3109708.png)
>
> - 小于4000时才会执行，大于就停止![img](https://api2.mubu.com/v3/document_image/25165450_2db7b98a-6de1-43a9-a346-3aa4a3dd7673.png)
>
> - 当大于等于500时才执行下面的逻辑，同时断掉自身逻辑![img](https://api2.mubu.com/v3/document_image/25165450_1827bfc4-816c-4777-cb37-9f04debd29b2.png)![img](https://api2.mubu.com/v3/document_image/25165450_a2cc6374-02c5-4178-cb17-d29a8e58175e.png)

------

### 为节点起别名

> ![img](https://api2.mubu.com/v3/document_image/25165450_f2168fba-a859-4895-e5bf-75f3df3aa480.png)

------

### 测试gif

> ![img](https://api2.mubu.com/v3/document_image/25165450_c934f57e-296f-46cd-c991-cf9e1d320127.png)


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________