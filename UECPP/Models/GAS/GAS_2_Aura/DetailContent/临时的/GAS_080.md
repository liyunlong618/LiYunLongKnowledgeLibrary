<details>
<summary>过程截图</summary>

>

------

</details>




+ `头文件`中：
```cpp
这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码这里是头文件代码
```

+ `源文件`中：
```cpp
这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码这里是源文件代码
```

[Mermaid格式参考](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/Mermaid%E6%A0%BC%E5%BC%8F%E5%8F%82%E8%80%83.md)

[预览](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/tree/main/UECPP/Models/GAS/GAS_2_Aura)



___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 080 行为树中实现敌人攻击逻辑；创建行为树任务BTTask

___________________________________________________________________________________________

## 处理关键点

1. 111111111111111111111111111111

2. 222222222222222222222222222

3. 33333333333333333333333333

4. 4444444444444444444444444444

5. 555555555555555555555555555555

6. 666666666666666666666666666

7. 77777777777777777777777777777777

___________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[8. Attack Behavior Tree Task_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1JD421E7yC?p=168&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 现在为了战斗，并没有任何内置的节点，所以我们需要创建自定义行为树任务BTTask

------

### 使用自定义任务节点的步骤：

>1. #### 实现ReceiveExeecuteAl函数
>
>![img](https://api2.mubu.com/v3/document_image/25165450_611e1aad-c779-45ff-ac61-03aea3838c30.png)
>
>2. #### 任务必须返回失败或者成功，否则将一直执行，占用线程
>
>     如果要返回成功或者失败，调用节点
>     
>     ![img](https://api2.mubu.com/v3/document_image/25165450_86d7910e-d40d-4317-8e2d-c82e343e896b.png)
>

------

### 创建自定义行为树任务BTTask

> - ### 在 `Aura/Public/AI/` 文件夹下
>
> - ### 创建自定义行为树任务C++类 `BTTask_BlueprintBase`，命名为 `BTTask_Attack`![img](https://api2.mubu.com/v3/document_image/25165450_76da6233-51a9-4b14-ca67-2a58147d9505.png)

------

### 我们去到 UBTTask_BlueprintBase 基类可以看到很多可以重写的虚函数

> - ## 最重要的是 执行任务 和 中止任务 的 虚函数
>
> ### 注意这个几个函数是私有的，不是 `Protected` ，不能重写!!!!!!!!!!![img](https://api2.mubu.com/v3/document_image/25165450_c3c03db1-423e-4c6f-a246-283fd177b9c3.png)
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_7524e52f-a18c-4780-bbc5-806a7cd96fd8.png)
>
> ### 这里调用了蓝图的![img](https://api2.mubu.com/v3/document_image/25165450_3ad6b41a-4de0-4a3b-9896-2bcd0956f4b7.png)

------

### 复制基类的虚函数到自建的BTTask_Attack中

> #### 需要调用 `super` ，因为 `super` 负责执行蓝图的逻辑![img](https://api2.mubu.com/v3/document_image/25165450_8fed5c18-e5f3-4003-e2e3-8e61b5983256.png)

------

### 接下来我们先处理近战攻击的逻辑

------

### 为 `自建的BTTask_Attack` 创建蓝图的继承类，命名为 `BTT_Attack`

> ![img](https://api2.mubu.com/v3/document_image/25165450_040d14e7-675e-4103-d0e9-b79c66141240.png)

------

### 实现ReceiveExeecuteAl函数

> ![img](https://api2.mubu.com/v3/document_image/25165450_6a4b7783-5cd9-47a6-f9ed-00c5d9f06e65.png)
> #### 先使用测试逻辑![img](https://api2.mubu.com/v3/document_image/25165450_a13112db-4205-4e50-e35a-a7df03dc103f.png)

------

### 接下来行为树中调用上面创建的战斗的节点 BTT_Attack

> - ### 这里注意一下不要调用成C++的版本，因为没有写逻辑![img](https://api2.mubu.com/v3/document_image/25165450_f4163208-733a-415f-c947-6f195abe49e9.png)![img](https://api2.mubu.com/v3/document_image/25165450_3658ebda-3d41-4663-c1fe-6f73e3b58e37.png)
>

------

### 测试gif

> - #### 刚开始不打印![img](https://api2.mubu.com/v3/document_image/25165450_cee8fdf2-8e42-46bf-ef4a-6a6a6c5da750.png)
>
> - #### 近到一定距离开始打印![img](https://api2.mubu.com/v3/document_image/25165450_aff39897-9415-4522-a2bb-1922ffbe6c06.png)

------

### 接下来，取消打印改成画测试球体

> ![img](https://api2.mubu.com/v3/document_image/25165450_a2ebc7e5-7a5e-4180-f7c6-52fe4056a4d6.png)

------

### 测试结果gif

> 远程敌人没有画球，近战敌人画球![img](https://api2.mubu.com/v3/document_image/25165450_1e03d1fb-5b5e-48ac-fcc6-1d8c43208d67.png)

------

### 近战敌人需要移动的更近一点

> - ### 添加 `MoveTo` 节点![img](https://api2.mubu.com/v3/document_image/25165450_735ac538-1260-485b-a396-38d973b7b0b2.png)
>
> - ### 可以改名字![img](https://api2.mubu.com/v3/document_image/25165450_04f14d69-2b16-4d76-8cd9-b74f59732122.png)

------

### 修改节点名字使行为树更加易读

------

### 测试结果gif

> 近战跟着走并画球，远程走到500![img](https://api2.mubu.com/v3/document_image/25165450_f5366989-17e7-4733-ddf8-9496ca4fef63.png)

------

### 还有一些问题，但是暂时不会处理，比如

> - #### 比如敌人之间不会影响导航，所以会忽视彼此，互相顶着走
>
> - #### 比如，按 `p` 显示 `NaviMesh` 没有白色的区域，说明没有影响NaviMesh导航
>
> ![img](https://api2.mubu.com/v3/document_image/25165450_aed0941d-b805-4c6d-a13d-5b82a5e49b16.png)
>
> - ### 暂时不调整，这些后面再说


___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________