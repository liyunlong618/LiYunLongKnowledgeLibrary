___________________________________________________________________________________________

###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 031 PC实现点击移动_参考官方 俯视角游戏模板
___________________________________________________________________________________________
## 处理关键点
1. 了解官方俯视角游戏DS/LS框架下的问题
2. 梳理点击移动的逻辑
___________________________________________________________________________________________

# 目录
- [GAS 031 PC实现点击移动\_参考官方 俯视角游戏模板](#gas-031-pc实现点击移动_参考官方-俯视角游戏模板)
  - [处理关键点](#处理关键点)
- [目录](#目录)
    - [视频链接](#视频链接)
    - [`AAuraPlayerController`中](#aauraplayercontroller中)
      - [头文件中创建几个变量](#头文件中创建几个变量)
        - [`FVector`:`CachedDestination`目标地点](#fvectorcacheddestination目标地点)
        - [`float`:`ShortPressThreshold`鼠标 短按/长按 区分的时间阈值](#floatshortpressthreshold鼠标-短按长按-区分的时间阈值)
        - [`float`:`FollowTime`鼠标 短按/长按 记录时间](#floatfollowtime鼠标-短按长按-记录时间)
        - [`bool`:`bAutoRunning`是否可以自动奔跑](#boolbautorunning是否可以自动奔跑)
        - [`bool`:`bTargeting`是否有目标（敌人）](#boolbtargeting是否有目标敌人)
        - [`float`:`AutoRunAcceptanceRadius`与目的地的距离](#floatautorunacceptanceradius与目的地的距离)
        - [`组件`:`Spline`样条线组件](#组件spline样条线组件)
        - [配置默认值](#配置默认值)
      - [源文件中](#源文件中)
        - [构造中 创建样条线组件](#构造中-创建样条线组件)
        - [鼠标按下时](#鼠标按下时)
        - [鼠标长按时](#鼠标长按时)
    - [想要达到,短按左键,自动跑 = `true`](#想要达到短按左键自动跑--true)
    - [此时效果gif](#此时效果gif)


___________________________________________________________________________________________



### 视频链接

[原理解析]("https://www.bilibili.com/video/BV1JD421E7yC?p=102&vd_source=9e1e64122d802b4f7ab37bd325a89e6c")

[课程链接]("https://www.bilibili.com/video/BV1JD421E7yC?p=103&vd_source=9e1e64122d802b4f7ab37bd325a89e6c")
___________________________________________________________________________________________


### `AAuraPlayerController`中

#### 头文件中创建几个变量
         
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/198225_532153.png?raw=true)
___________________________________________________________________________________________


##### `FVector`:`CachedDestination`目标地点

##### `float`:`ShortPressThreshold`鼠标 短按/长按 区分的时间阈值

##### `float`:`FollowTime`鼠标 短按/长按 记录时间


##### `bool`:`bAutoRunning`是否可以自动奔跑

##### `bool`:`bTargeting`是否有目标（敌人）

##### `float`:`AutoRunAcceptanceRadius`与目的地的距离

##### `组件`:`Spline`样条线组件
             
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/389897_312219.png?raw=true)
___________________________________________________________________________________________


##### 配置默认值  
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/206031_286271.png?raw=true)
___________________________________________________________________________________________


#### 源文件中
___________________________________________________________________________________________


##### 构造中 创建样条线组件
___________________________________________________________________________________________


##### 鼠标按下时
`AbilityInputTagPressed` 函数中,若传进来的tag是LMB的Tag（说明短按下左键）,如果 `ThisActor == nullptr` , `bTargeting=false` : `ThisActor != nullptr` , `bTargeting=true` :此时不是长按的触发时机,所以 `bAutoRunning = false` :
             
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/298057_721158.png?raw=true)
- 之前在勾边时,创建过一个ThisActor指针（指向当前鼠标正在指向的Actor）若该目标没有实现接口,就是nullptr
___________________________________________________________________________________________


##### 鼠标长按时
 AbilityInputTagHeld 函数中,如果传进来的tag不是LMB的Tag（说明不是长按的左键）,此时执行检查ASC组件,调用ASC组件中的回调函数（旧逻辑）然后返回:下面是按左键的逻辑,若 `bTargeting == true` 说明左键点击了敌人,此时执行检查ASC组件,调用ASC组件中的回调函数（旧逻辑）然后返回:else说明左键没有点击敌人即 `bTargeting == false` 此处处理的才是长按点击移动的逻辑: `FollowTime+=DeltaTime` 发射一条射线,如果击中物体, `CachedDestination目标地点 = 击中点` ,如果能拿到控制的角色,先计算 <font color=#75C940>Dir ,然后 AddMovementInput
             
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/359080_13488.png?raw=true)
___________________________________________________________________________________________


### 想要达到,短按左键,自动跑 = `true`
___________________________________________________________________________________________


### 此时效果gif 
 
![图片](https://github.com/liyunlong618/LiYunLongKnowledgeLibrary/blob/main/UECPP/Models/GAS/GAS_2_Aura/DetailContent/Image/GAS_031/291019_98446.gif?raw=true)
_ 

___________________________________________________________________________________________

[返回最上面](#Go主菜单)
___________________________________________________________________________________________