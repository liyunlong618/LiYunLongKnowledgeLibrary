___________________________________________________________________________________________
###### [Go主菜单](../MainMenu.md)
___________________________________________________________________________________________

# GAS 132 创建技能树菜单UI；处理打开和关闭逻辑
_________________________________________________________________________________________

# 目录


[TOC]


___________________________________________________________________________________________

<details>
<summary>视频链接</summary>

[1. Spell Menu Design_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=68&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[2. Spell Globe Button_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=69&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[3. Offensive Spell Tree_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=70&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[4. Passive Spell Tree_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=71&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[5. Equipped Spell Row_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=72&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[6. Spell Menu Widget_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=73&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[7. Spell Description Box_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=74&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

[8. Spell Menu Button_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1TH4y1L7NP/?p=75&spm_id_from=pageDriver&vd_source=9e1e64122d802b4f7ab37bd325a89e6c)

------

</details>

___________________________________________________________________________________________

### Mermaid整体思路梳理

Mermaid

___________________________________________________________________________________________

### 接下来我们将制作技能树菜单，从上到下依次为主要技能，被动技能，装备的技能
>![img](./Image/GAS_132/1.png)


------

### 下一节


------

### 虽然技能球和原来的差不多但是不能复用，因为有一些逻辑和回调，需要复制一份，处理一下

  - 命名为，***WBP_SpellGlobe_Button***

>![img](./Image/GAS_132/2.png)


------

### 添加 `Image`，设为锁的 `icon`
>![img](./Image/GAS_132/3.png)


------

### 下面想把外面这一圈环 变成 按钮
>![img](./Image/GAS_132/4.png)

- 需要把旧的环删除换成 `button`
>![img](./Image/GAS_132/5.png)
>![img](./Image/GAS_132/6.png)


------

#### 为环的Button配置资产
>![img](./Image/GAS_132/7.png)


------

### 下面将创建一个当技能被选中时的动画，打算使用Image来制作，制作完先隐藏
>![img](./Image/GAS_132/8.png)
>![img](./Image/GAS_132/9.png)
>![img](./Image/GAS_132/10.png)

- 然后删除多余逻辑


------

### 这样就完成了基础的按钮


------

### 下一节


------

### 下面我们将制作图中红色部分，也就是主要技能的UI部分
>![img](./Image/GAS_132/11.png)


------

#### 创建 `技能树菜单` UI的文件夹

  - 命名为，`SpellMenu`

>![img](./Image/GAS_132/12.png)


------

#### 创建UI继承自 `AuraUserWidget`
>![img](./Image/GAS_132/13.png)


------

#### 创建函数 `UpdateBoxSize` 
>![img](./Image/GAS_132/14.png)
>![img](./Image/GAS_132/15.png)


------

#### 加入几个 `WrapBox` ，然后加入刚才创建的技能按钮
>![img](./Image/GAS_132/16.png)


------

#### 从属性菜单，拷贝背景和标题，整一些要用的元素
>![img](./Image/GAS_132/17.png)


------

#### 放入 ***WBP_Overlay***
>![img](./Image/GAS_132/18.png)


------

### 运行游戏，看下效果
>![img](./Image/GAS_132/19.png)


------

#### 加一个SizeBox，设置大小
>![img](./Image/GAS_132/20.png)


------

#### 加入Image分隔
>![img](./Image/GAS_132/21.png)


------

#### 左右使用Spacer分隔
>![img](./Image/GAS_132/22.png)


------

### 运行游戏查看效果
>![img](./Image/GAS_132/23.png)


------

### 下一节


------

### 这节我们来制作被动技能的部分
>![img](./Image/GAS_132/24.png)


------

#### 之前的这个最大的菜单部分挪到新的里面，旧的里面只保留部分
>![img](./Image/GAS_132/25.png)
>![img](./Image/GAS_132/26.png)


------

#### 复制一份主要技能的技能树UI，制作被动技能技能树

  - 命名为，***WBP_PassiveSpellTree***

>![img](./Image/GAS_132/27.png)


------

#### 设置一下 大小 和 间距
>![img](./Image/GAS_132/28.png)
>![img](./Image/GAS_132/29.png)


------

#### 测试一下按钮点击和悬浮效果gif
>![img](./Image/GAS_132/30.gif)


------

### 下一节


------

### 这一节我们来制作，装备的技能部分
>![img](./Image/GAS_132/31.png)


------

#### 复制一个新的

  - 命名为，***WBP_EquippedSpellRow***

>![img](./Image/GAS_132/32.png)


------

#### 做一个这样的效果
>![img](./Image/GAS_132/33.png)


------

### 运行查看一下效果
>![img](./Image/GAS_132/34.png)


------

### 下一节


------

### 制作技能面板
>![img](./Image/GAS_132/35.png)


------

### 加入技能点
>![img](./Image/GAS_132/36.png)
>![img](./Image/GAS_132/37.png)


------

### 下一节


------

### 做一个这样的效果
>![img](./Image/GAS_132/38.png)


------

#### 自己看着实现
>![img](./Image/GAS_132/39.png)


------

### 下一节


------

### 我们也需要一个技能树的按钮UI
>![img](./Image/GAS_132/40.png)


------

### 根据之前的创建属性菜单的逻辑修改


------

#### 技能树面板创建事件分发器，关闭时移除，然后广播
>![img](./Image/GAS_132/41.png)
>![img](./Image/GAS_132/42.png)


------

#### ***WBP_Overlay*** 中生成技能树UI面板并设置窗口偏移，绑定回调
>![img](./Image/GAS_132/43.png)


------

### 现在有一个情况，当UI挡住视野时，依旧可以移动，这里的设定是，当UI开启时，禁止点击移动


------

#### ***WBP_Overlay*** 中创建两个bool变量分别代表两个菜单是否打开，只有当两个菜但都关闭时，才能继续移动

  - 在点击和触发回调时设置

>![img](./Image/GAS_132/44.png)


------

### 此时效果gif

> ![2024-09-16 03-16-08](./Image/GAS_132/45.gif)

___________________________________________________________________________________________

[返回最上面](#Go主菜单)

___________________________________________________________________________________________